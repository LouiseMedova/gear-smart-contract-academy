"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.GearMessage = void 0;
const errors_1 = require("./errors");
const utils_1 = require("./utils");
const Transaction_1 = require("./Transaction");
class GearMessage extends Transaction_1.GearTransaction {
    /**
     * Send message
     * @param message Message parameters
     * @param meta Metadata
     * @param messageType MessageType
     * @returns Submitted result
     * ```javascript
     * const api = await GearApi.create()
     * const programId = '0xd7540ae9da85e33b47276e2cb4efc2f0b58fef1227834f21ddc8c7cb551cced6'
     * api.message.submit({
     *  destination: messageId,
     *  payload: 'Hello, World!',
     *  gasLimit: 20_000_000
     * }, undefiend, 'String')
     * api.message.signAndSend(account, (events) => {
     *  events.forEach(({event}) => console.log(event.toHuman()))
     * })
     * ```
     */
    submit(message, meta, messageType) {
        let payload = (0, utils_1.createPayload)(this.createType, messageType || (meta === null || meta === void 0 ? void 0 : meta.handle_input), message.payload, meta);
        try {
            this.submitted = this.api.tx.gear.sendMessage(message.destination, payload, message.gasLimit, message.value || 0);
            return this.submitted;
        }
        catch (error) {
            throw new errors_1.SendMessageError();
        }
    }
}
exports.GearMessage = GearMessage;
